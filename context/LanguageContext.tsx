
import React, { createContext, useState, useContext, ReactNode, useEffect, useCallback } from 'react';

type Language = 'en' | 'pt';

interface LanguageContextType {
    language: Language;
    setLanguage: (language: Language) => void;
    t: (key: string, replacements?: { [key: string]: string }) => string;
}

const translations: { [lang in Language]: { [key: string]: string } } = {
  en: {
    // ... existing translations ...
    achVexScholarTitle: "Vexillological Scholar",
    achVexScholarDesc: "Analyze details of 200 unique national designs.",
    achQuizVeteranTitle: "Quiz Veteran",
    achQuizVeteranDesc: "Complete 100 full quizzes across any game mode.",
    achStreakGodTitle: "Vexillology God",
    achStreakGodDesc: "Reach an incredible streak of 50 correct answers in a row.",
    achCollectionMasterTitle: "Grand Global Patron",
    achCollectionMasterDesc: "Collect 75 favorite flags in your personal registry.",
    achDesignLegendTitle: "Legendary Herald",
    achDesignLegendDesc: "Master the design studio by creating 50 unique flags.",
    achCuriousMindTitle: "Curious Mind",
    achCuriousMindDesc: "Engage with Vexy Gemini by asking 5 insightful questions.",
    achAIExpertTitle: "AI Specialist",
    achAIExpertDesc: "Request 25 deep dives from Vexy Gemini's knowledge base.",
    achAnalystTitle: "Comparative Analyst",
    achAnalystDesc: "Analyze and compare 10 pairs of flags side-by-side.",
    achMasterAnalystTitle: "Grand Master of Analysis",
    achMasterAnalystDesc: "Conduct 50 meticulous side-by-side comparisons.",
    // Rest of strings mapped correctly...
    title: "World Flag Explorer",
    headerTitle: "World Flags",
    explorer: "Explore",
    exploreTitle: "Flag of the Day",
    exploreSubtitle: "Uncover the history, symbolism, and vibrant colors behind the world's national flags. Use our filters to navigate the global tapestry of heraldry.",
    searchPlaceholder: "Search by country name or code...",
    fetchError: "Failed to retrieve country data. Please try again later.",
    api_fetch_error: "Connection error: Unable to load flag data.",
    errorOops: "Something went wrong",
    noResults: "No flags match your current search criteria.",
    noFlagsFound: "No Flags Found",
    noFlagsFoundDescription: "Try adjusting your filters or search term to discover more nations.",
    viewDetailsFor: "View details for {{countryName}}",
    flagOf: "Flag of {{country}}",
    closeModal: "Close",
    continents: "Continent",
    capital: "Capital",
    population: "Population",
    area: "Total Area",
    areaUnit: "km¬≤",
    coatOfArms: "Coat of Arms",
    viewOnMap: "Locate on Google Maps",
    goToTop: "Back to top",
    footerRights: `¬© ${new Date().getFullYear()} World Flag Explorer. All rights reserved.`,
    footerBuiltWith: "Powered by React & Tailwind CSS | Data provided by REST Countries",
    showingFlags: "Displaying {{count}} of {{total}} flags",
    loadingFlags: "Loading global registry...",
    startQuiz: "Launch Quiz",
    quizTitle: "Vexillology Quiz",
    questionOf: "Question {{current}} of {{total}}",
    whichCountry: "To which country does this flag belong?",
    whichFlag: "Which of these is the flag of {{country}}?",
    nextQuestion: "Continue",
    quizResults: "Performance Summary",
    yourScore: "Accuracy: {{score}} / {{total}}",
    playAgain: "New Game",
    backToExplorer: "Return to Gallery",
    scoreFeedbackExcellent: "Masterful! Your knowledge of flags is world-class.",
    scoreFeedbackGood: "Impressive work! You have a strong grasp of global flags.",
    scoreFeedbackAverage: "Good effort! A bit more exploration and you'll be an expert.",
    scoreFeedbackPoor: "A great start! Keep exploring to unlock the secrets of vexillology.",
    discoverTitle: "Discover",
    discoverIntro: "Deep dive into the fascinating world of vexillology. Explore curated collections, unique designs, and rich global symbolism.",
    discoverLoading: "Curating a new collection for you...",
    flagOfTheDay: "Flag of the Day",
    flagOfTheDayLoading: "Selecting today's highlight...",
    filterAndSearch: "Search & Filter",
    filterByContinent: "By Continent",
    quizSetupTitle: "Quiz Center",
    chooseMode: "Select Challenge Mode",
    selectDifficulty: "Set Difficulty",
    difficultyEasy: "Easy",
    difficultyMedium: "Standard",
    difficultyHard: "Expert",
    difficultyEasyDesc: "Focuses on the most populous and well-known nations.",
    difficultyMediumDesc: "A balanced mix of nations from all corners of the globe.",
    difficultyHardDesc: "Challenge yourself with lesser-known and remote territories.",
    modeFlagToCountry: "Flag ‚ûû Country",
    modeFlagToCountryDesc: "Identify the nation associated with the flag.",
    modeCountryToFlag: "Country ‚ûû Flag",
    modeCountryToFlagDesc: "Select the correct flag for the given nation.",
    modeFlagToCapital: "Flag ‚ûû Capital",
    modeFlagToCapitalDesc: "Name the capital city based on the national flag.",
    modeCountryToCapital: "Country ‚ûû Capital",
    modeCountryToCapitalDesc: "Match the sovereign state with its capital city.",
    whichCapitalForCountry: "What is the capital city of {{country}}?",
    modeShapeToCountry: "Heraldry ‚ûû Country",
    modeShapeToCountryDesc: "Identify the nation by its official Coat of Arms.",
    whichCapital: "What is the capital of this country?",
    whichCoatOfArms: "Which nation's Coat of Arms is displayed here?",
    modeFlagle: "Flagle (Pixel Challenge)",
    modeFlagleDesc: "Guess the nation hidden behind a pixelated flag.",
    modeOddOneOut: "The Intruder",
    modeOddOneOutDesc: "Find the flag that doesn't belong to the region.",
    whichIsTheOddOneOut: "Which flag is the odd one out?",
    backToMenu: "Exit to Menu",
    quizTime: "Elapsed Time",
    quizAvgTime: "Average Pace",
    quizSeconds: "{{seconds}}s",
    compareMode: "Comparison Engine",
    compareModeTooltip: "Enable to select and compare two flags side-by-side",
    exitCompareMode: "Exit Comparison",
    selectForComparison: "Select {{countryName}} for side-by-side view",
    compareFlags: "Compare ({{count}}/2)",
    clearSelection: "Reset",
    comparisonTitle: "Flag Comparison Analysis",
    favorites: "My Collection",
    noFavorites: "Your collection is empty",
    noFavoritesDescription: "Mark flags with a heart to save them to your personal favorites.",
    addToFavorites: "Add to favorites",
    removeFromFavorites: "Remove from favorites",
    addedToFavoritesToast: "{{countryName}} saved to favorites.",
    removedFromFavoritesToast: "{{countryName}} removed from favorites.",
    toggleTheme: "Toggle Light/Dark mode",
    scrollLeft: "Scroll left",
    scrollRight: "Scroll right",
    continentTab: "Regions",
    toolsTab: "Utilities",
    quizStreak: "üî• {{count}} Correct Streak",
    quizHint: "Hint ({{count}} remaining)",
    quizNoHints: "No hints available",
    quizReviewAnswers: "Analyze Performance",
    quizBackToSummary: "Back to Results",
    quizReviewTitle: "Detailed Review",
    quizYourAnswer: "Your selection:",
    quizCorrectAnswer: "Correct answer:",
    continentHint: "Regional Clue: Located in {{continent}}.",
    quizBestStreak: "Highest Streak",
    quizAccuracy: "Accuracy Rate",
    quizRank: "Acheived Rank",
    rankNovice: "Flag Novice",
    rankApprentice: "Heraldry Apprentice",
    rankAdept: "Vexillology Adept",
    rankExpert: "Flag Specialist",
    rankMaster: "Global Vexillologist",
    quiz5050Hint: "50:50 ({{count}} remaining)",
    quizNo5050Hints: "50:50 exhausted",
    quizCorrect: "Correct",
    quizIncorrect: "Incorrect",
    sortBy: "Order by",
    sortNameAsc: "Name (A-Z)",
    sortNameDesc: "Name (Z-A)",
    sortPopAsc: "Population (Increasing)",
    sortPopDesc: "Population (Decreasing)",
    sortAreaAsc: "Area (Increasing)",
    sortAreaDesc: "Area (Decreasing)",
    selectACountry: "Select a Nation",
    uniqueFlags: "Notable Designs",
    uniqueFlagOfTheDayTitle: "Design Highlight of the Day",
    flagFactsTitle: "Vexillological Insights",
    showAnotherFact: "Next Insight",
    achievementsSubtitle: "Monitor your progress and milestones in global exploration.",
    symbolismExplorerTitle: "Symbolism Engine",
    symbolSun: "Celestial Sun",
    symbolCrescent: "Lunar Crescent",
    symbolCross: "Heraldic Cross",
    symbolStar: "Astral Star",
    symbolAnimal: "Fauna & Wildlife",
    symbolWeapon: "Defense & Arms",
    symbolMap: "Cartography",
    symbolBuilding: "Architecture",
    noFlagsForSymbol: "No matches found for this symbol category.",
    achievementUnlocked: "Milestone Achieved!",
    progress: "Current Progress",
    newBadge: "NEW",
    level: "Level",
    xp: "XP",
    nextLevelAt: "Next Level at {{xp}} XP",
    totalXP: "Total Experience",
    vexMastery: "Vexillology Mastery",
    flagsViewed: "Flags Viewed",
    perfectQuizzes: "Perfect Quizzes",
    maxStreak: "Max Streak",
    designs: "Designs",
    rarityCommon: "Common",
    rarityRare: "Rare",
    rarityEpic: "Epic",
    rarityLegendary: "Legendary",
    cat_explorer: "Global Voyager",
    cat_quiz: "Intellectual Master",
    cat_collector: "Vexillology Curator",
    cat_designer: "Creative Visionary",
    achFirstStepsTitle: "Inaugural Discovery",
    achFirstStepsDesc: "Explore your very first national flag.",
    achWorldTravelerTitle: "Global Wayfarer",
    achWorldTravelerDesc: "Uncover the details of 50 unique flags.",
    achCenturyClubTitle: "Century Explorer",
    achCenturyClubDesc: "Reach the milestone of 100 flags explored.",
    achVexExpertTitle: "Vexillology Authority",
    achVexExpertDesc: "Deep dive into 150 different national designs.",
    achMasterExplorerTitle: "Sovereign of Earth",
    achMasterExplorerDesc: "Complete the global registry by viewing all 240+ flags.",
    achQuizStarterTitle: "Academic Pursuit",
    achQuizStarterDesc: "Successfully complete your first knowledge challenge.",
    achQuizScholarTitle: "Active Scholar",
    achQuizScholarDesc: "Demonstrate consistency by completing 10 full quizzes.",
    achQuizMarathonerTitle: "Knowledge Marathoner",
    achQuizMarathonerDesc: "A true academic! Complete 50 quizzes across any mode.",
    achPerfectScoreTitle: "Flawless Execution",
    achPerfectScoreDesc: "Achieve 100% accuracy in any quiz challenge.",
    achPerfectLegendTitle: "Immaculate Legend",
    achPerfectLegendDesc: "Achieve 10 perfect scores. True perfection is rare.",
    achStreakMasterTitle: "Unstoppable Momentum",
    achStreakMasterDesc: "Maintain a streak of 10 consecutive correct answers.",
    achStreakGodlikeTitle: "Vexillology God",
    achStreakGodlikeDesc: "Reach an incredible streak of 25 correct answers in a row.",
    achCuratorTitle: "Registry Curator",
    achCuratorDesc: "Build a personal collection of 10 favorite flags.",
    achCollectorProTitle: "Passionate Collector",
    achCollectorProDesc: "Grow your private flag collection to 25 entries.",
    achWorldCuratorTitle: "Grand Global Curator",
    achWorldCuratorDesc: "Collect 50 favorite flags. You have the world in your hands.",
    achArtistTitle: "Heraldic Designer",
    achArtistDesc: "Create and export your own unique flag design.",
    achProlificDesignerTitle: "Prolific Creator",
    achProlificDesignerDesc: "Master the patterns and layouts by creating 10 designs.",
    achDesignVisionaryTitle: "Master of Tinctures",
    achDesignVisionaryDesc: "Establish yourself as a master by creating 30 unique designs.",
    dataManagement: "Progress Management",
    exportData: "Export Progress",
    importData: "Import Progress",
    resetData: "Reset All Progress",
    resetConfirm: "Are you sure? This will wipe your levels and achievements forever.",
    dataImported: "Progress successfully restored!",
    dataExported: "Backup file generated.",
    flagFactsList: "[\"**Nepal** is the only sovereign nation with a non-quadrilateral flag design.\", \"The flag of **Denmark** holds the record as the oldest national flag in continuous use, dating back to 1219.\", \"**Jamaica** is currently the only national flag that does not feature the colors red, white, or blue.\", \"**Switzerland** and **Vatican City** are the only two states with officially square national flags.\", \"The flag of **Mozambique** is the only one to feature a modern assault rifle, representing national defense.\", \"**Belize** is unique for having a national flag that features human figures as a central element.\", \"The **Philippines** flag is unique: it is flown upside down (red stripe on top) during times of official war.\", \"**Libya** previously held the record for the only solid-color national flag (pure green).\", \"The celestial bodies on **Nepal's** flag symbolize the hope for national longevity alongside the sun and moon.\", \"The colors of the **South African** flag represent unity and diversity in the wake of its history.\"]",
    mapTitle: "Global Cartography",
    mapSubtitle: "Navigate the world through geography and location.",
    mapComingSoon: "Geographical Navigator",
    mapModeInstructions: "Use the map to browse countries by location. Tap a country tag to reveal its full flag and statistical profile.",
    nepalFlagDesc: "The world's only non-quadrilateral national flag.",
    switzerlandFlagDesc: "A perfectly square design, rare among sovereign states.",
    vaticanFlagDesc: "The second of only two officially square national flags.",
    paraguayFlagDesc: "Unique for having different emblems on the front and back.",
    denmarkFlagDesc: "Recognized as the world's oldest continuously used flag.",
    philippinesFlagDesc: "A flag that signals war when flown inverted.",
    mozambiqueFlagDesc: "A modern design featuring a kalashnikov for defense.",
    qatarFlagDesc: "The only national flag with a width more than twice its height.",
    belizeFlagDesc: "Distinguished by the inclusion of human figures in its seal.",
    cyprusFlagDesc: "One of the few flags to feature a literal map of the nation.",
    brazilFlagDesc: "A celestial snapshot of the sky over Rio on Nov 15, 1889.",
    austriaFlagDesc: "Rooted in legend, among the oldest designs in Europe.",
    lesothoFlagDesc: "Features the 'Mokorotlo', a traditional Basotho hat.",
    cambodiaFlagDesc: "The only national flag to feature a building (Angkor Wat).",
    turkmenistanFlagDesc: "Considered the most complex and detailed flag design.",
    sriLankaFlagDesc: "The 'Lion Flag', symbolizing bravery and the nation's origins.",
    canadaFlagDesc: "The iconic Maple Leaf, a symbol of nature and identity.",
    southAfricaFlagDesc: "A vibrant 'Rainbow Nation' design adopted in 1994.",
    dominicanRepublicFlagDesc: "The only national flag featuring an open Bible.",
    jamaicaFlagDesc: "A unique design free from red, white, and blue colors.",
    norwayFlagDesc: "Often called the 'Mother of all flags' due to hidden designs within.",
    ugandaFlagDesc: "Centrally features the Grey Crowned Crane, a symbol of gentleness.",
    bhutanFlagDesc: "Features the Thunder Dragon (Druk) from local mythology.",
    libyaFlagDesc: "Now featuring the crescent, formerly a solid green field.",
    saudiArabiaFlagDesc: "The only flag never flown at half-mast due to the sacred creed.",
    kiribatiFlagDesc: "A literal representation of the archipelago's location.",
    dominicaFlagDesc: "Features the Sisserou Parrot, a bird unique to the island.",
    eswatiniFlagDesc: "Displays the shield and spears of the Emasotsha regiment.",
    southKoreaFlagDesc: "Centered on the 'Taegeuk', representing cosmic balance.",
    lebanonFlagDesc: "Features the Cedar, a symbol of holiness and eternity.",
    kenyaFlagDesc: "The Maasai shield symbolizes the defense of national freedom.",
    grenadaFlagDesc: "The 'Spice Isle', featuring a nutmeg clove on its hoist.",
    mexicoFlagDesc: "Based on the Aztec legend of the founding of Tenochtitlan.",
    kyrgyzstanFlagDesc: "The sun's 40 rays represent the 40 original Kyrgyz tribes.",
    antiguaBarbudaFlagDesc: "Symbolizing a new era (sun) and African heritage (black).",
    seychellesFlagDesc: "Radiating bands symbolize a dynamic country moving forward.",
    vanuatuFlagDesc: "The boar's tusk symbolizes wealth and traditional peace.",
    eritreaFlagDesc: "The olive branch wreath symbolizes hard-won autonomy.",
    filterByColor: "Filter by Tincture",
    showingFlagsWith: "Designs featuring {{color}}",
    noFlagsForColor: "No designs match this specific tincture.",
    bicolorHorizontal: "Horizontal Bicolor",
    bicolorVertical: "Vertical Bicolor",
    tricolorHorizontal: "Horizontal Tricolor",
    tricolorVertical: "Vertical Tricolor",
    nordicCross: "Nordic Cross",
    noSymbol: "No Emblem",
    star: "Astral Star",
    circle: "Orb/Circle",
    mainColor: "Primary Field",
    crossColor: "Cross Tincture",
    colorN: "Tincture {{n}}",
    flagDesignerTitle: "Heraldry Workshop",
    flagDesignerSubtitle: "Compose your own unique flag using traditional vexillological patterns and symbols.",
    layout: "Structural Layout",
    colors: "Color Palette",
    symbol: "Central Emblem",
    symbolColor: "Emblem Tincture",
    actions: "Management",
    randomize: "Generate Random",
    download: "Export SVG",
    guessTheFlag: "Mystery Flag",
    guessesLeft: "{{count}} attempts remaining",
    congratulations: "Victory!",
    gameOver: "Challenge Ended",
    correctAnswerWas: "The correct identity was {{country}}",
    nextFlagIn: "Next challenge in",
    enterCountryName: "Type nation name...",
    all: "Complete Registry",
    allQuestions: "All Available Questions",
    numberOfQuestions: "{{count}} Questions",
    selectNumberOfQuestions: "Define Session Length",
    combo: "COMBO X{{n}}",
    timeLeft: "{{n}}s",
    speedBonus: "Speed Bonus: +{{n}}",
    outOfTime: "Time Expired!",
    explored: "Explored",
    addToComparison: "Add to Comparison",
    removeFromComparison: "Remove from Comparison",
    guessesLabel: "GUESSES",
    excellentLabel: "EXCELLENT!",
    youWonLabel: "YOU WON!",
    correctAnswerWasLabel: "The flag was from",
    hintNameStarts: "Hint: The name starts with",
    hintRegion: "Hint: Located in region:",
    hitsLabel: "HITS",
    questionLabel: "Question"
  },
  pt: {
    achVexScholarTitle: "Erudito Vexilol√≥gico",
    achVexScholarDesc: "Analise os detalhes de 200 designs nacionais √∫nicos.",
    achQuizVeteranTitle: "Veterano dos Quizzes",
    achQuizVeteranDesc: "Complete 100 quizzes em qualquer modo de jogo.",
    achStreakGodTitle: "Semideus da Vexilologia",
    achStreakGodDesc: "Alcance uma sequ√™ncia incr√≠vel de 50 acertos seguidos.",
    achCollectionMasterTitle: "Grande Patrono Global",
    achCollectionMasterDesc: "Colecione 75 bandeiras favoritas no seu registro pessoal.",
    achDesignLegendTitle: "Arauto Lend√°rio",
    achDesignLegendDesc: "Domine o est√∫dio de design criando 50 bandeiras √∫nicas.",
    achCuriousMindTitle: "Mente Curiosa",
    achCuriousMindDesc: "Interaja com o Vexy Gemini fazendo 5 perguntas perspicazes.",
    achAIExpertTitle: "Especialista em IA",
    achAIExpertDesc: "Solicite 25 an√°lises profundas da base de conhecimento do Vexy.",
    achAnalystTitle: "Analista Comparativo",
    achAnalystDesc: "Analise e compare 10 pares de bandeiras lado a lado.",
    achMasterAnalystTitle: "Gr√£o-Mestre da An√°lise",
    achMasterAnalystDesc: "Realize 50 compara√ß√µes detalhadas lado a lado.",
    // Correct mappings...
    title: "Explorador de Bandeiras",
    headerTitle: "Bandeiras do Mundo",
    explorer: "Explorar",
    exploreTitle: "Bandeira do Dia",
    exploreSubtitle: "Descubra a hist√≥ria, o simbolismo e as cores vibrantes por tr√°s das bandeiras das na√ß√µes. Utilize nossos filtros para navegar pela rica tape√ßaria da her√°ldica global.",
    searchPlaceholder: "Pesquise por nome ou sigla...",
    fetchError: "N√£o foi poss√≠vel obter os dados. Tente novamente em instantes.",
    api_fetch_error: "Erro de conex√£o: N√£o foi poss√≠vel carregar os dados das bandeiras.",
    errorOops: "Algo deu errado",
    noResults: "Nenhuma bandeira corresponde aos crit√©rios atuais.",
    noFlagsFound: "Nenhuma Bandeira Encontrada",
    noFlagsFoundDescription: "Tente ajustar seus filtros ou termos de busca para descobrir novas na√ß√µes.",
    viewDetailsFor: "Ver detalhes de {{countryName}}",
    flagOf: "Bandeira de {{country}}",
    closeModal: "Fechar",
    continents: "Continente",
    capital: "Capital",
    population: "Popula√ß√£o",
    area: "√Årea Total",
    areaUnit: "km¬≤",
    coatOfArms: "Bras√£o de Armas",
    viewOnMap: "Localizar no Google Maps",
    goToTop: "Voltar ao topo",
    footerRights: `¬© ${new Date().getFullYear()} Explorador de Bandeiras. Todos os direitos reservados.`,
    footerBuiltWith: "Desenvolvido com React & Tailwind CSS | Dados via REST Countries",
    showingFlags: "Exibindo {{count}} de {{total}} bandeiras",
    loadingFlags: "Carregando registro global...",
    startQuiz: "Iniciar Desafio",
    quizTitle: "Quiz Vexilol√≥gico",
    questionOf: "Quest√£o {{current}} de {{total}}",
    whichCountry: "A qual pa√≠s pertence esta bandeira?",
    whichFlag: "Qual destas √© a bandeira de {{country}}?",
    nextQuestion: "Continuar",
    quizResults: "Resumo de Desempenho",
    yourScore: "Precis√£o: {{score}} / {{total}}",
    playAgain: "Novo Jogo",
    backToExplorer: "Voltar √† Galeria",
    scoreFeedbackExcellent: "Magistral! Seu conhecimento √© de um verdadeiro especialista.",
    scoreFeedbackGood: "Trabalho impressionante! Voc√™ conhece muito bem o mapa-m√∫ndi.",
    scoreFeedbackAverage: "Bom esfor√ßo! Mais algumas rodadas e voc√™ ser√° um expert.",
    scoreFeedbackPoor: "Um √≥timo come√ßo! Continue explorando para dominar a vexilologia.",
    discoverTitle: "Descobrir",
    discoverIntro: "Mergulhe no fascinante universo da vexilologia. Explore cole√ß√µes curadas, designs √∫nicos e o rico simbolismo global.",
    discoverLoading: "Preparando uma nova cole√ß√£o para voc√™...",
    flagOfTheDay: "Bandeira do Dia",
    flagOfTheDayLoading: "Selecionando o destaque de hoje...",
    filterAndSearch: "Busca & Filtros",
    filterByContinent: "Por Continente",
    quizSetupTitle: "Centro de Desafios",
    chooseMode: "Escolha o Modo de Jogo",
    selectDifficulty: "N√≠vel de Dificuldade",
    difficultyEasy: "Iniciante",
    difficultyMedium: "Padr√£o",
    difficultyHard: "Especialista",
    difficultyEasyDesc: "Focado nas na√ß√µes mais populosas e conhecidas mundialmente.",
    difficultyMediumDesc: "Uma mistura equilibrada de pa√≠ses de todos os cantos do globo.",
    difficultyHardDesc: "Dasafio-se com territ√≥rios remotos e na√ß√µes menos conhecidas.",
    modeFlagToCountry: "Bandeira ‚ûû Pa√≠s",
    modeFlagToCountryDesc: "Identifique a na√ß√£o associada √† bandeira exibida.",
    modeCountryToFlag: "Pa√≠s ‚ûû Bandeira",
    modeCountryToFlagDesc: "Selecione a bandeira correta para a na√ß√£o indicada.",
    modeFlagToCapital: "Bandeira ‚ûû Capital",
    modeFlagToCapitalDesc: "Identifique a capital com base na bandeira nacional.",
    modeCountryToCapital: "Pa√≠s ‚ûû Capital",
    modeCountryToCapitalDesc: "Relacione o estado soberano √† sua respectiva capital.",
    whichCapitalForCountry: "Qual √© a capital de {{country}}?",
    modeShapeToCountry: "Her√°ldica ‚ûû Pa√≠s",
    modeShapeToCountryDesc: "Identifique a na√ß√£o atrav√©s do seu Bras√£o de Armas oficial.",
    whichCapital: "Qual √© a capital deste pa√≠s?",
    whichCoatOfArms: "De qual na√ß√£o √© este Bras√£o de Armas?",
    modeFlagle: "Flagle (Desafio Pixelado)",
    modeFlagleDesc: "Adivinhe o pa√≠s oculto por tr√°s de uma bandeira em baixa resolu√ß√£o.",
    modeOddOneOut: "O Intruso",
    modeOddOneOutDesc: "Encontre a bandeira que n√£o pertence √† regi√£o exibida.",
    whichIsTheOddOneOut: "Qual destas bandeiras √© a intrusa?",
    backToMenu: "Sair para o Menu",
    quizTime: "Tempo Decorrido",
    quizAvgTime: "Ritmo M√©dio",
    quizSeconds: "{{seconds}}s",
    compareMode: "Motor de Compara√ß√£o",
    compareModeTooltip: "Ative para selecionar e comparar duas bandeiras lado a lado",
    exitCompareMode: "Sair da Compara√ß√£o",
    selectForComparison: "Selecionar {{countryName}} para an√°lise comparativa",
    compareFlags: "Comparar ({{count}}/2)",
    clearSelection: "Reiniciar",
    comparisonTitle: "An√°lise Comparativa de Bandeiras",
    favorites: "Minha Cole√ß√£o",
    noFavorites: "Sua cole√ß√£o est√° vazia",
    noFavoritesDescription: "Marque bandeiras com um cora√ß√£o para salv√°-las na sua cole√ß√£o pessoal.",
    addToFavorites: "Adicionar aos favoritos",
    removeFromFavorites: "Remover dos favoritos",
    addedToFavoritesToast: "{{countryName}} adicionado aos favoritos.",
    removedFromFavoritesToast: "{{countryName}} removido dos favoritos.",
    toggleTheme: "Alternar modo Claro/Escuro",
    scrollLeft: "Rolar para esquerda",
    scrollRight: "Rolar para direita",
    continentTab: "Regi√µes",
    toolsTab: "Utilit√°rios",
    quizStreak: "üî• Sequ√™ncia de {{count}} Acertos",
    quizHint: "Dica (restam {{count}})",
    quizNoHints: "Sem dicas dispon√≠veis",
    quizReviewAnswers: "Analisar Desempenho",
    quizBackToSummary: "Voltar aos Resultados",
    quizReviewTitle: "Revis√£o Detalhada",
    quizYourAnswer: "Sua sele√ß√£o:",
    quizCorrectAnswer: "Resposta correta:",
    continentHint: "Pista Regional: Localizado em {{continent}}.",
    quizBestStreak: "Maior Sequ√™ncia",
    quizAccuracy: "Taxa de Acerto",
    quizRank: "Patente Alcan√ßada",
    rankNovice: "Novato em Bandeiras",
    rankApprentice: "Aprendiz de Her√°ldica",
    rankAdept: "Adepto da Vexilologia",
    rankExpert: "Especialista em Bandeiras",
    rankMaster: "Vexilologista Global",
    quiz5050Hint: "50:50 (restam {{count}})",
    quizNo5050Hints: "50:50 esgotado",
    quizCorrect: "Correto",
    quizIncorrect: "Incorreto",
    sortBy: "Ordenar por",
    sortNameAsc: "Nome (A-Z)",
    sortNameDesc: "Nome (Z-A)",
    sortPopAsc: "Popula√ß√£o (Crescente)",
    sortPopDesc: "Popula√ß√£o (Decrescente)",
    sortAreaAsc: "√Årea (Crescente)",
    sortAreaDesc: "√Årea (Decrescente)",
    selectACountry: "Selecione uma Na√ß√£o",
    uniqueFlags: "Designs Not√°veis",
    uniqueFlagOfTheDayTitle: "Destaque de Design do Dia",
    flagFactsTitle: "Curiosidades Vexilol√≥gicas",
    showAnotherFact: "Pr√≥xima Curiosidade",
    achievementsSubtitle: "Acompanhe seu progresso e marcos na explora√ß√£o global.",
    symbolismExplorerTitle: "Motor de Simbolismo",
    symbolSun: "Sol Celestial",
    symbolCrescent: "Crescente Lunar",
    symbolCross: "Cruz Her√°ldica",
    symbolStar: "Estrela Astral",
    symbolAnimal: "Fauna e Vida Selvagem",
    symbolWeapon: "Defesa e Armas",
    symbolMap: "Cartografia",
    symbolBuilding: "Arquitetura",
    noFlagsForSymbol: "Nenhum resultado para esta categoria de s√≠mbolo.",
    achievementUnlocked: "Marco Alcan√ßado!",
    progress: "Progresso Atual",
    newBadge: "NOVO",
    level: "N√≠vel",
    xp: "XP",
    nextLevelAt: "Pr√≥ximo n√≠vel em {{xp}} XP",
    totalXP: "Experi√™ncia Total",
    vexMastery: "Dom√≠nio Vexilol√≥gico",
    flagsViewed: "Bandeiras Vistas",
    perfectQuizzes: "Quizzes Perfeitos",
    maxStreak: "Melhor Sequ√™ncia",
    designs: "Designs Criados",
    rarityCommon: "Comum",
    rarityRare: "Rara",
    rarityEpic: "√âpica",
    rarityLegendary: "Lend√°ria",
    cat_explorer: "Viajante Global",
    cat_quiz: "Mestre Intelectual",
    cat_collector: "Curador de Bandeiras",
    cat_designer: "Vision√°rio Criativo",
    achFirstStepsTitle: "Descoberta Inaugural",
    achFirstStepsDesc: "Explore sua primeira bandeira nacional.",
    achWorldTravelerTitle: "Andarilho do Mundo",
    achWorldTravelerDesc: "Descubra os detalhes de 50 bandeiras √∫nicas.",
    achCenturyClubTitle: "Explorador do S√©culo",
    achCenturyClubDesc: "Alcance o marco de 100 bandeiras exploradas.",
    achVexExpertTitle: "Autoridade em Vexilologia",
    achVexExpertDesc: "Analise profundamente 150 designs nacionais diferentes.",
    achMasterExplorerTitle: "Soberano da Terra",
    achMasterExplorerDesc: "Complete o registro global visualizando todas as mais de 240 bandeiras.",
    achQuizStarterTitle: "Jornada Acad√™mica",
    achQuizStarterDesc: "Conclua com sucesso seu primeiro desafio de conhecimento.",
    achQuizScholarTitle: "Estudioso Ativo",
    achQuizScholarDesc: "Demonstre consist√™ncia completando 10 quizzes completos.",
    achQuizMarathonerTitle: "Maratonista do Saber",
    achQuizMarathonerDesc: "Um verdadeiro acad√™mico! Complete 50 quizzes em qualquer modo.",
    achPerfectScoreTitle: "Execu√ß√£o Impec√°vel",
    achPerfectScoreDesc: "Alcance 100% de precis√£o em qualquer desafio do quiz.",
    achPerfectLegendTitle: "Lenda Imaculada",
    achPerfectLegendDesc: "Alcance 10 pontua√ß√µes perfeitas. A perfei√ß√£o real √© rara.",
    achStreakMasterTitle: "Momento Impar√°vel",
    achStreakMasterDesc: "Mantenha uma sequ√™ncia de 10 acertos consecutivos.",
    achStreakGodlikeTitle: "Deus da Vexilologia",
    achStreakGodlikeDesc: "Alcance uma sequ√™ncia incr√≠vel de 25 acertos seguidos.",
    achCuratorTitle: "Curador do Registro",
    achCuratorDesc: "Construa uma cole√ß√£o pessoal com 10 bandeiras favoritas.",
    achCollectorProTitle: "Colecionador Apaixonado",
    achCollectorProDesc: "Aumente sua cole√ß√£o privada para 25 bandeiras.",
    achWorldCuratorTitle: "Grande Curador Global",
    achWorldCuratorDesc: "Colecione 50 bandeiras favoritas. O mundo est√° em suas m√£os.",
    achArtistTitle: "Designer Her√°ldico",
    achArtistDesc: "Crie e exporte seu pr√≥prio design exclusivo de bandeira.",
    achProlificDesignerTitle: "Criador Prol√≠fico",
    achProlificDesignerDesc: "Domine os padr√µes e layouts criando 10 designs.",
    achDesignVisionaryTitle: "Mestre das Tinturas",
    achDesignVisionaryDesc: "Consagre-se como um mestre criando 30 designs √∫nicos.",
    dataManagement: "Gerenciamento de Dados",
    exportData: "Exportar Progresso",
    importData: "Importar Progresso",
    resetData: "Resetar Todo o Progresso",
    resetConfirm: "Tem certeza? Isso apagar√° seus n√≠veis e conquistas para sempre.",
    dataImported: "Progresso restaurado com sucesso!",
    dataExported: "Arquivo de backup gerado.",
    flagFactsList: "[\"O **Nepal** √© a √∫nica na√ß√£o soberana com uma bandeira nacional n√£o quadril√°tera.\", \"A bandeira da **Dinamarca** √© reconhecida como a mais antiga em uso cont√≠nuo, datando de 1219.\", \"A **Jamaica** √© atualmente a √∫nica bandeira nacional que n√£o cont√©m as cores vermelho, branco ou azul.\", \"A **Su√≠√ßa** e o **Vaticano** s√£o os √∫nicos dois estados com bandeiras nacionais oficialmente quadradas.\", \"A bandeira de **Mo√ßambique** √© a √∫nica a apresentar um rifle de assalto moderno, simbolizando a defesa nacional.\", \"**Belize** destaca-se por ter a √∫nica bandeira nacional que apresenta figuras humanas como elemento central.\", \"A bandeira das **Filipinas** tem um uso √∫nico: √© hasteada invertida (vermelho no topo) em tempos de guerra oficial.\", \"A **L√≠bia** j√° ostentou a √∫nica bandeira de cor s√≥lida do mundo (totalmente verde).\", \"Os corpos celestes na bandeira do **Nepal** simbolizam a esperan√ßa de que a na√ß√£o dure tanto quanto o sol e a lua.\", \"As cores da bandeira da **√Åfrica do Sul** simbolizam a unidade e diversidade ap√≥s sua reconstru√ß√£o hist√≥rica.\"]",
    mapTitle: "Cartografia Global",
    mapSubtitle: "Navegue pelo mundo atrav√©s da geografia e localiza√ß√£o.",
    mapComingSoon: "Navegador Geogr√°fico",
    mapModeInstructions: "Use o mapa para explorar pa√≠ses por localiza√ß√£o. Toque na tag de um pa√≠s para revelar sua bandeira e perfil estat√≠stico.",
    nepalFlagDesc: "A √∫nica bandeira nacional n√£o quadril√°tera do mundo.",
    switzerlandFlagDesc: "Um design perfeitamente quadrado, raro entre estados soberanos.",
    vaticanFlagDesc: "A segunda de apenas duas bandeiras oficialmente quadradas.",
    paraguayFlagDesc: "√önica por apresentar emblemas diferentes no anverso e no reverso.",
    denmarkFlagDesc: "Reconhecida como a bandeira mais antiga do mundo em uso cont√≠nuo.",
    philippinesFlagDesc: "Uma bandeira que sinaliza estado de guerra quando invertida.",
    mozambiqueFlagDesc: "Design moderno que apresenta uma kalashnikov para defesa.",
    qatarFlagDesc: "A √∫nica bandeira nacional com largura superior ao dobro de sua altura.",
    belizeFlagDesc: "Distingue-se pela inclus√£o de figuras humanas em seu selo oficial.",
    cyprusFlagDesc: "Uma das poucas bandeiras a exibir o mapa literal da pr√≥pria na√ß√£o.",
    brazilFlagDesc: "Um retrato do c√©u sobre o Rio de Janeiro em 15 de novembro de 1889.",
    austriaFlagDesc: "Baseada em lendas medievais, entre os designs mais antigos da Europa.",
    lesothoFlagDesc: "Exibe o 'Mokorotlo', um chap√©u tradicional do povo Basoto.",
    cambodiaFlagDesc: "A √∫nica bandeira nacional a apresentar um edif√≠cio (Angkor Wat).",
    turkmenistanFlagDesc: "Considerada a bandeira com o design mais complexo e detalhado do mundo.",
    sriLankaFlagDesc: "A 'Bandeira do Le√£o', simbolizando a bravura e as origens da na√ß√£o.",
    canadaFlagDesc: "A ic√¥nica Folha de Bordo, s√≠mbolo de natureza e identidade canadense.",
    southAfricaFlagDesc: "O design da 'Na√ß√£o Arco-√çris', adotado oficialmente em 1994.",
    dominicanRepublicFlagDesc: "A √∫nica bandeira nacional que apresenta uma B√≠blia aberta.",
    jamaicaFlagDesc: "Um design exclusivo, livre das cores vermelho, branco e azul.",
    norwayFlagDesc: "Frequentemente chamada de 'M√£e de todas as bandeiras' por conter outros designs ocultos.",
    ugandaFlagDesc: "Apresenta centralmente o Grou-coroado, s√≠mbolo de eleg√¢ncia e mansid√£o.",
    bhutanFlagDesc: "Exibe o Drag√£o do Trov√£o (Druk) da mitologia local.",
    libyaFlagDesc: "Atualmente com o crescente, anteriormente um campo verde s√≥lido.",
    saudiArabiaFlagDesc: "A √∫nica bandeira nunca hasteada a meio-mastro devido ao seu credo sagrado.",
    kiribatiFlagDesc: "Uma representa√ß√£o literal da localiza√ß√£o geogr√°fica do arquip√©lago.",
    dominicaFlagDesc: "Apresenta o Papagaio-imperial, ave end√™mica da ilha.",
    eswatiniFlagDesc: "Exibe o escudo e as lan√ßas do regimento Emasotsha.",
    southKoreaFlagDesc: "Centrada no 'Taegeuk', representando o equil√≠brio c√≥smico.",
    lebanonFlagDesc: "Apresenta o Cedro, s√≠mbolo de santidade e eternidade.",
    kenyaFlagDesc: "O escudo Maasai simboliza a prontid√£o na defesa da liberdade nacional.",
    grenadaFlagDesc: "A 'Ilha das Especiarias', exibindo um dente de noz-moscada em seu design.",
    mexicoFlagDesc: "Inspirada na lenda asteca sobre a funda√ß√£o de Tenochtitl√°n.",
    kyrgyzstanFlagDesc: "Os 40 raios do sol representam as 40 tribos originais do Quirguist√£o.",
    antiguaBarbudaFlagDesc: "Simboliza uma nova era (sol) and a heran√ßa africana (preto).",
    seychellesFlagDesc: "Faixas radiantes simbolizam um pa√≠s din√¢mico em constante movimento.",
    vanuatuFlagDesc: "A presa de javali simboliza prosperidade e a paz tradicional.",
    eritreaFlagDesc: "A coroa de ramos de oliveira simboliza a autonomia conquistada.",
    filterByColor: "Filtrar por Tintura",
    showingFlagsWith: "Designs que utilizam {{color}}",
    noFlagsForColor: "Nenhum resultado para esta categoria de s√≠mbolo.",
    bicolorHorizontal: "Bicolor Horizontal",
    bicolorVertical: "Bicolor Vertical",
    tricolorHorizontal: "Tricolor Horizontal",
    tricolorVertical: "Tricolor Vertical",
    nordicCross: "Cruz N√≥rdica",
    noSymbol: "Sem Emblema",
    star: "Estrela Astral",
    circle: "C√≠rculo/Orbe",
    mainColor: "Campo Prim√°rio",
    crossColor: "Tintura da Cruz",
    colorN: "Tintura {{n}}",
    flagDesignerTitle: "Oficina de Her√°ldica",
    flagDesignerSubtitle: "Componha sua pr√≥pria bandeira utilizando padr√µes e s√≠mbolos tradicionais da vexilologia.",
    layout: "Estrutura do Layout",
    colors: "Paleta de Cores",
    symbol: "Emblema Central",
    symbolColor: "Tintura do Emblema",
    actions: "Gerenciamento",
    randomize: "Gerar Aleat√≥ria",
    download: "Exportar SVG",
    guessTheFlag: "Bandeira Mist√©rio",
    guessesLeft: "{{count}} tentativas restantes",
    congratulations: "Vit√≥ria!",
    gameOver: "Desafio Encerrado",
    correctAnswerWas: "A identidade correta era {{country}}",
    nextFlagIn: "Pr√≥ximo desafio em",
    enterCountryName: "Digite o nome da na√ß√£o...",
    all: "Registro Completo",
    allQuestions: "Todas as Quest√µes Dispon√≠veis",
    numberOfQuestions: "{{count}} Quest√µes",
    selectNumberOfQuestions: "Definir Dura√ß√£o da Sess√£o",
    combo: "COMBO X{{n}}",
    timeLeft: "{{n}}s",
    speedBonus: "B√¥nus de Velocidade: +{{n}}",
    outOfTime: "Tempo Expirado!",
    explored: "Explorado",
    addToComparison: "Adicionar √† Compara√ß√£o",
    removeFromComparison: "Remover da Compara√ß√£o",
    guessesLabel: "PALPITES",
    excellentLabel: "EXCELENTE!",
    youWonLabel: "VOC√ä VENCEU!",
    correctAnswerWasLabel: "A bandeira era de",
    hintNameStarts: "Dica: O nome come√ßa com",
    hintRegion: "Dica: Localizado na regi√£o:",
    hitsLabel: "ACERTOS",
    questionLabel: "Quest√£o"
  }
};

const LanguageContext = createContext<LanguageContextType | undefined>(undefined);

export const LanguageProvider: React.FC<{ children: ReactNode }> = ({ children }) => {
    const [language, setLanguageState] = useState<Language>(() => {
        const saved = localStorage.getItem('language');
        if (saved === 'en' || saved === 'pt') return saved;
        return navigator.language.startsWith('pt') ? 'pt' : 'en';
    });

    const setLanguage = useCallback((lang: Language) => {
        setLanguageState(lang);
        localStorage.setItem('language', lang);
        document.documentElement.lang = lang;
    }, []);

    useEffect(() => {
        document.documentElement.lang = language;
    }, [language]);

    const t = useCallback((key: string, replacements?: { [key: string]: string }) => {
        let text = translations[language][key] || translations['en'][key] || key;
        
        if (replacements) {
            Object.entries(replacements).forEach(([k, v]) => {
                text = text.replace(`{{${k}}}`, v);
            });
        }
        
        return text;
    }, [language]);

    return (
        <LanguageContext.Provider value={{ language, setLanguage, t }}>
            {children}
        </LanguageContext.Provider>
    );
};

export const useLanguage = () => {
    const context = useContext(LanguageContext);
    if (context === undefined) {
        throw new Error('useLanguage must be used within a LanguageProvider');
    }
    return context;
};
